
<!doctype html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>ButtCaster Overlay</title>
<link rel="stylesheet" href="/css/overlay.css">
<link rel="stylesheet" href="/css/brand.css">
<link rel="stylesheet" href="/css/overlay-brand.css">
<script src="/socket.io/socket.io.js"></script>
<script src="/js/overlay-brand.js" defer></script>
<style>.pill{background:linear-gradient(90deg,#ff7ac8,#9ad8ff); border-radius:18px; box-shadow:0 10px 30px rgba(120,60,140,.18);} .goal{background:#eef1f6b0; border-radius:18px; backdrop-filter: blur(6px); box-shadow: inset 0 0 0 1px rgba(100,120,150,.18);} .element{position:absolute; user-select:none;}</style>
</head>
<body>
<div class="stage" id="stage">
  <div class="glow" id="glow"></div>
  <div class="canvas" id="canvas" style="position:absolute; inset:0"></div>
</div>
<script>
const s = io(); let elements=[], overlay={showWatermark:true, glow:true, goalTarget:2000, goalValue:0};
const canvas=document.getElementById('canvas'), glow=document.getElementById('glow');
function px(n){ return (n|0)+'px' }
function render(){
  canvas.innerHTML='';
  elements.forEach(el=>{
    const d=document.createElement('div'); d.className='element'; d.style.left=px(el.x); d.style.top=px(el.y); d.style.width=px(el.w||600); d.style.height=px(el.h||60);
    if(el.type==='goalbar'){ const tr=document.createElement('div'); tr.className='goal'; tr.style.position='absolute'; tr.style.inset='0';
      const fill=document.createElement('div'); fill.className='pill'; fill.style.position='absolute'; fill.style.left='12px'; fill.style.top='12px'; fill.style.bottom='12px';
      const pct=Math.max(0, Math.min(1, (overlay.goalTarget? overlay.goalValue/overlay.goalTarget:0))); fill.style.width='calc('+(pct*100)+'% - 24px)';
      const lab=document.createElement('div'); lab.className='label'; lab.style.top='-36px'; lab.style.left='0'; lab.textContent=`Remaining: ${Math.max(0,(overlay.goalTarget||0)-(overlay.goalValue||0))}`;
      d.appendChild(tr); d.appendChild(fill); d.appendChild(lab);
    } else if(el.type==='text'){ d.style.fontWeight='800'; d.style.fontSize=px(el.size||48); d.textContent=el.text||'TEXT'; d.style.color=el.color||'#0a0d14'; }
    else if(el.type==='image'){ d.style.background='#e9edf3'; d.style.borderRadius='12px'; }
    canvas.appendChild(d);
  });
  glow.style.display = overlay.glow?'block':'none';
}
s.on('overlay:settings', cfg=>{ overlay={...overlay,...cfg}; render(); });
s.on('overlay:elements', els=>{ elements=els||[]; render(); });
s.on('overlay:goal', g=>{ overlay.goalValue=g.current; overlay.goalTarget=g.target; render(); });
s.on('overlay:goal-reached', ()=>{ /* TODO: optional confetti */ });
</script>
</body></html>
