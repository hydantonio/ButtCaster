<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ButtCaster â€¢ Control</title>
  <link rel="stylesheet" href="css/badge.css">
  <link rel="icon" href="../public/logo-buttcaster.svg">
  <style>
    body { margin:0; font: 16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Calibri, sans-serif; background:#f7f8fb; color:#0a0d14;}
    header { display:flex; align-items:center; justify-content:space-between; gap:12px; padding:12px 16px; background:#fff; border-bottom:1px solid #e6e9f2; position:sticky; top:0; z-index:5;}
    .brand { display:flex; align-items:center; gap:10px; font-weight:900; letter-spacing:.2px;}
    .brand img { width:28px; height:28px; }
    main { padding:16px; max-width:1000px; margin:0 auto; }
    .row { display:flex; gap:12px; flex-wrap:wrap; align-items:center; }
    .card { background:#fff; border:1px solid #e6e9f2; border-radius:12px; padding:14px; box-shadow: 0 6px 18px rgba(60,80,130,.12); }
    button { cursor:pointer; border:1px solid #e6e9f2; border-radius:12px; padding:10px 12px; background:#fff; font-weight:800; }
    input[type="text"] { padding:10px 12px; border:1px solid #e6e9f2; border-radius:12px; min-width:260px; font-weight:600; }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <img src="../public/logo-buttcaster.svg" alt="ButtCaster logo">
      <span>ButtCaster Control</span>
    </div>
    <div id="badge">
      <span id="badge-conn" title="Disconnected"></span>
      <span id="badge-devices">0 devices</span>
    </div>
  </header>

  <main>
    <section class="card">
      <div class="row">
        <input id="wsurl" type="text" value="ws://127.0.0.1:12345" aria-label="Intiface WS URL">
        <button id="btn-connect">Connect</button>
        <button id="btn-disconnect">Disconnect</button>
        <button id="btn-vibe">Vibrate test</button>
      </div>
    </section>
  </main>

  <script type="module">
    import { connectIntiface, disconnectIntiface, vibrateTest, onDeviceCount } from "./js/intiface.js";
    import { enableRightSidebarResize } from "./js/layout.js";
    // No right sidebar here, but keep util available if you add one in this view.

    onDeviceCount(n => console.log("[Control] Devices:", n));

    const wsurl = document.getElementById("wsurl");
    const btnConnect = document.getElementById("btn-connect");
    const btnDisconnect = document.getElementById("btn-disconnect");
    const btnVibe = document.getElementById("btn-vibe");

    btnConnect.addEventListener("click", () => connectIntiface(wsurl.value).catch(console.error));
    btnDisconnect.addEventListener("click", () => disconnectIntiface().catch(console.error));
    btnVibe.addEventListener("click", () => vibrateTest(0.6, 1200).catch(console.error));
  </script>
</body>
</html>
